<form [formGroup]="form" novalidate (ngSubmit)="onSubmit()">
  <mat-stepper #stepper>
    <mat-step [stepControl]="firstFormGroup">
      <form [formGroup]="firstFormGroup">
        <ng-template matStepLabel>Create your community</ng-template>

        <!-- <div>
          <p>You want to create your own community? Great!</p>
          <p>
            On Ariton, communities are important and we want both the owners, and the members to have a great
            experience.
          </p>
          <p>We work very hard to make sure Ariton is a great place for communities, so we.</p>
        </div> -->

        <div>
          <div class="storage-container">
            <mat-icon class="storage-icon" inline="true">diversity_1</mat-icon>
            <h1>Choose the feature options</h1>
            <p>Choose the features you want to include in your community. You can always change these later on.</p>
            <p>
              <mat-button-toggle-group formControlName="premiumPeriod">
                <mat-button-toggle value="monthly">Monthly</mat-button-toggle>
                <mat-button-toggle value="annual">Annual</mat-button-toggle>
              </mat-button-toggle-group>
            </p>
          </div>

          <div class="offers">
            @if (premiumPeriod === 'monthly') {
            <mat-card class="offer-card">
              <mat-card-header>
                <mat-icon mat-card-avatar>cloud</mat-icon>
                <mat-card-title>Free (1 GB)</mat-card-title>
                <mat-card-subtitle>Ideal for small and private communities.</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p>Your current storage option.</p>
              </mat-card-content>
              <mat-card-actions>
                <button mat-button [disabled]="true">CURRENT</button>
              </mat-card-actions>
            </mat-card>

            <mat-card class="offer-card">
              <mat-card-header>
                <mat-icon mat-card-avatar>cloud_done</mat-icon>
                <mat-card-title>Basic (10 GB)</mat-card-title>
                <mat-card-subtitle>$2 for 1 month</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p>Upgrade your current storage to 10x the amount of storage for only $2 per month.</p>
                <!-- <mat-chip-set>
        <mat-chip>charming</mat-chip>
        <mat-chip>graceful</mat-chip>
        <mat-chip>sassy</mat-chip>
      </mat-chip-set> -->
              </mat-card-content>
              <mat-card-actions>
                <button mat-button>CHOOSE</button>
              </mat-card-actions>
            </mat-card>

            <mat-card class="offer-card">
              <mat-card-header>
                <mat-icon mat-card-avatar>cloud_done</mat-icon>
                <mat-card-title>Standard (50 GB)</mat-card-title>
                <mat-card-subtitle>$8 for 1 month</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p>
                  This option is perfect for those who need more storage than the Basic plan, if you plan on storing
                  more photos and files this is a great option for you.
                </p>
              </mat-card-content>
              <mat-card-actions>
                <button mat-button>CHOOSE</button>
              </mat-card-actions>
            </mat-card>

            <mat-card class="offer-card">
              <mat-card-header>
                <mat-icon mat-card-avatar>cloud_done</mat-icon>
                <mat-card-title>Premium (100 GB)</mat-card-title>
                <mat-card-subtitle>$14 for 1 month</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p>
                  For only $14 per month you can get 100 GB of storage, this is perfect for those who need to store a
                  lot of files.
                </p>
              </mat-card-content>
              <mat-card-actions>
                <button mat-button>CHOOSE</button>
              </mat-card-actions>
            </mat-card>
            } @else {
            <mat-card class="offer-card">
              <mat-card-header>
                <mat-icon mat-card-avatar>cloud</mat-icon>
                <mat-card-title>Standard (1 GB)</mat-card-title>
                <mat-card-subtitle>Free</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p>Your current storage option.</p>
              </mat-card-content>
              <mat-card-actions>
                <button mat-button [disabled]="true">CURRENT</button>
              </mat-card-actions>
            </mat-card>

            <mat-card class="offer-card">
              <mat-card-header>
                <mat-icon mat-card-avatar>cloud_done</mat-icon>
                <mat-card-title>Basic (10 GB)</mat-card-title>
                <mat-card-subtitle>$22 for 1 years</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p>Upgrade your current storage to 10x the amount of storage for only $22 per year.</p>
                <!-- <mat-chip-set>
        <mat-chip>charming</mat-chip>
        <mat-chip>graceful</mat-chip>
        <mat-chip>sassy</mat-chip>
      </mat-chip-set> -->
              </mat-card-content>
              <mat-card-actions>
                <button mat-button>CHOOSE</button>
              </mat-card-actions>
            </mat-card>

            <mat-card class="offer-card">
              <mat-card-header>
                <mat-icon mat-card-avatar>cloud_done</mat-icon>
                <mat-card-title>Standard (50 GB)</mat-card-title>
                <mat-card-subtitle>$88 for 1 year</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p>
                  This option is perfect for those who need more storage than the Basic plan, if you plan on storing
                  more photos and files this is a great option for you.
                </p>
              </mat-card-content>
              <mat-card-actions>
                <button mat-button>CHOOSE</button>
              </mat-card-actions>
            </mat-card>

            <mat-card class="offer-card">
              <mat-card-header>
                <mat-icon mat-card-avatar>cloud_done</mat-icon>
                <mat-card-title>Premium (100 GB)</mat-card-title>
                <mat-card-subtitle>$322 for 1 year</mat-card-subtitle>
              </mat-card-header>
              <mat-card-content>
                <p>
                  For only $322 per year you can get 100 GB of storage, this is perfect for those who need to store a
                  lot of files.
                </p>
              </mat-card-content>
              <mat-card-actions>
                <button mat-button>CHOOSE</button>
              </mat-card-actions>
            </mat-card>
            }
          </div>
        </div>

        <!-- <mat-form-field>
          <mat-label>Name</mat-label>
          <input matInput placeholder="Last name, First name" formControlName="firstCtrl" required />
        </mat-form-field> -->
        <div>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>
    <mat-step [stepControl]="secondFormGroup" label="Fill out details">
      <div>
        <app-avatar formControlName="avatar"></app-avatar>

        <mat-card class="form-card">
          <mat-card-content>
            <mat-form-field class="full-width">
              <mat-label>Community name</mat-label>
              <input matInput #name placeholder="Community name" maxlength="200" formControlName="name" />
            </mat-form-field>

            <mat-form-field class="full-width">
              <mat-label>Community type</mat-label>
              <mat-select formControlName="type">
                @for (type of communityTypes; track type) {
                <mat-option [value]="type.type">{{ type.name }}</mat-option>
                }
              </mat-select>
            </mat-form-field>

            <!-- <mat-form-field class="full-width">
        <mat-label>Title</mat-label>
        <input matInput #title placeholder="Title" formControlName="title" />
        @if (form.controls['title'].hasError('required')) {
        <mat-error>Title is <strong>required</strong></mat-error>
        }
      </mat-form-field>

      <mat-form-field class="full-width">
        <mat-label>Status</mat-label>
        <input matInput placeholder="Status" formControlName="status" />
        @if (form.controls['status'].hasError('required')) {
        <mat-error>Status is <strong>required</strong></mat-error>
        }
      </mat-form-field> -->

            <mat-form-field class="full-width">
              <mat-label>About</mat-label>
              <textarea maxlength="300" matInput #bio placeholder="About" formControlName="bio"></textarea>
              @if (form.controls['bio'].hasError('required')) {
              <mat-error>About is <strong>required</strong></mat-error>
              }
              <mat-hint align="end">{{ bio.value.length }} / 300</mat-hint>
            </mat-form-field>

            <!-- <mat-form-field class="full-width">
        <mat-label>Location</mat-label>
        <input matInput placeholder="Location" formControlName="location" />
        @if (form.controls['location'].hasError('required')) {
        <mat-error>Location is <strong>required</strong></mat-error>
        }
        <mat-icon matSuffix>place</mat-icon>
      </mat-form-field> -->

            <!--
            <mat-form-field class="full-width">
           
                <mat-select placeholder="State" formControlName="state">
                @for (state of states; track state) {
                  <mat-option [value]="state.abbreviation">{{ state.name }}</mat-option>
                }
              </mat-select>
              @if (addressForm.controls['state'].hasError('required')) {
                <mat-error>State is <strong>required</strong></mat-error>
              }
            </mat-form-field>-->

            <!--
        <div class="row">
          <div class="col">
            <mat-form-field class="full-width">
              <input matInput #postalCode maxlength="5" placeholder="Postal Code" type="number" formControlName="postalCode">
              <mat-hint align="end">{{postalCode.value.length}} / 5</mat-hint>
            </mat-form-field>
          </div>
        </div>-->

            <!-- In your component.html -->
            <!-- Step 5: Update HTML to display dynamic link inputs -->
            <!--<div formArrayName="links" *ngFor="let link of links.controls; let i = index">-->
            <div formArrayName="owners">
              @for (owner of owners.controls; track owner; let i = $index) {
              <div class="link-input">
                <mat-form-field class="full-width">
                  <input matInput type="text" [formControlName]="i" placeholder="Owner (DID)" />
                </mat-form-field>
                <!-- <button mat-stroked-button type="button" (click)="removeLink(i)">Remove</button> -->
                <button mat-icon-button type="button" (click)="removeOwner(i)"><mat-icon>clear</mat-icon></button>
              </div>
              }
            </div>
            <button mat-stroked-button type="button" (click)="addOwner()">
              <mat-icon>add_link</mat-icon> Add Owner
            </button>

            <!--
        <div class="row">
          <div class="col">
            <mat-radio-group formControlName="shipping">
              <mat-radio-button value="free">Free Shipping</mat-radio-button>
              <mat-radio-button value="priority">Priority Shipping</mat-radio-button>
              <mat-radio-button value="nextday">Next Day Shipping</mat-radio-button>
            </mat-radio-group>
          </div>
        </div>-->
          </mat-card-content>
          <mat-card-actions align="end">
            <button mat-button type="button" (click)="back()">Cancel</button>
            <button mat-flat-button color="primary" type="submit" [disabled]="form.invalid">Save</button>
          </mat-card-actions>
        </mat-card>
      </div>

      <form [formGroup]="secondFormGroup">
        <mat-form-field>
          <mat-label>Address</mat-label>
          <input matInput formControlName="secondCtrl" placeholder="Ex. 1 Main St, New York, NY" required />
        </mat-form-field>
        <div>
          <button mat-button matStepperPrevious>Back</button>
          <button mat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Done</ng-template>
      <p>You are now done.</p>
      <div>
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="stepper.reset()">Reset</button>
      </div>
    </mat-step>
  </mat-stepper>
</form>
